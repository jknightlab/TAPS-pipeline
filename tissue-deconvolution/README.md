# Deconvolution of tissue contributions to cfDNA based on methylation patterns

Author:		Eddie Cano-Gamez

Email:		ecg@well.ox.ac.uk


## Overview

This directory contains codes to extract methylation information (i.e. proportion of methylated reads) at CpG sites known to be hyper- or hypo-methyalted in a tissue specific manner. These variables are then used to infer tissue proportions within a sample by comparing the methylation signal at these CpGs to a curated tissue atlas.

The tissue atlas used as a basis for this analysis was generated by Moss et al. using Illumina methylation arrays (https://doi.org/10.1038/s41467-018-07466-6)

The algorithm used for deconvolution was taken from the work published by Loyfer et al. (https://github.com/nloyfer/meth_atlas). 


## Repository structure

The codes contained within this repository are written in bash and R, and ordered as follows:

```
./
 |-- 1_match-CpGs-to-Illumina-probes.R	Takes methylation calls derived using methylKit (see main section of this repository) and summarises them for CpGs covered in the Illumina EPIC and 450K arrays. The output is a methylation proportion table with CpG sites (labelled according to Illumina IDs) as rows and samples as columns.
 |-- 2_format-tissue-atlas.R		Performs pre-processing of the tissue atlas published by Moss et al., including batch correction to remove systematic differences between one EPIC array study and the rest of the data set.
 `-- 3_deconvolute-array-methylomes.sh	Takes as input the outputs from codes 1 and 2 and uses them to deconvolute the relative contribution of each tissue in the reference tissue atlas to the methylation profile of each cfDNA sample.
```

